$(document).on("change",".toggle-checkbox__input",(function(){let that=$(this),currency=that.closest(".complects-list__item-text-top-part").data("currency"),$parent=that.closest(".toggle-checkbox"),price=+$parent.data("price"),priceOld=+$parent.data("oldprice"),$pricesBlock=that.closest(".complects-list__item-text-wrapper").find(".complects-list__item-text-bottom-part .price"),$priceNew=$pricesBlock.find(".price__new-val"),$priceOld=$pricesBlock.find(".price__old-val"),$priceDiff=$pricesBlock.find(".price__economy-val"),summPrice=+$priceNew.text().replace(/\D/g,""),summPriceOld=+$priceOld.text().replace(/\D/g,"");that.is(":checked")?(summPrice+=price,summPriceOld+=priceOld):(summPrice-=price,summPriceOld-=priceOld),$priceNew.html(number_format(summPrice,0,"."," ")+" "+currency),$priceOld.html(number_format(summPriceOld,0,"."," ")+" "+currency),$priceDiff.length&&$priceDiff.html(number_format(summPriceOld-summPrice,0,"."," ")+" "+currency)})),$(document).on("click",".opt_action",(function(){const _this=$(this),$parent=_this.closest(".complects-list__item-text-wrapper"),$serviceParent=$parent.find(".services-complect");_this.hasClass("no-action")||setTimeout((function(){const basketItems=[],itemsToNotice=[$parent[0]],obj=$parent.data("item");obj.QUANTITY=1,basketItems.push(obj),$serviceParent.length&&$serviceParent.find(".complect-props__name").each((function(){const _this=$(this),add=_this.find(".toggle-checkbox__input").is(":checked");if(add){itemsToNotice.push(_this[0]);const obj=_this.data("item");obj.QUANTITY=1,basketItems.push(obj)}})),basketItems.forEach((function(obj){if("object"===typeofExt(arBasketItems)||"array"===typeofExt(arBasketItems))if("undefined"===typeofExt(arBasketItems[obj.ID]))arBasketItems[obj.ID]={ID:obj.ID,QUANTITY:obj.QUANTITY},obj.PARENT_ID&&(arBasketItems[obj.ID].PARENT_ID=obj.PARENT_ID);else{const quantity=+arBasketItems[obj.ID].QUANTITY;arBasketItems[obj.ID].QUANTITY=quantity+obj.QUANTITY}})),optBuyBasketAction(basketItems,itemsToNotice)}),0)})),BX.addCustomEvent("onCompleteAction",(function(eventdata,_this){eventdata.action&&"loadBasket"===eventdata.action&&$(".opt_action").parent().removeClass("loadings")}));